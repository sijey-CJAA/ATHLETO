{% extends "base.html" %}

{% block admin_navbar %}
  {% include "admin_navbar.html" %}
{% endblock %}

{% block content %}
<div class="container">
    <h2>Receipt #{{ receipt.id }} Items</h2>
    <p>
        <strong>User Email:</strong> {{ receipt.user_email }}<br>
        <strong>Name:</strong> {{ receipt.name }}<br>
        <strong>Date:</strong> {{ receipt.timestamp }}
    </p>
    <!-- Print Button -->
    <button class="btn btn-primary mb-3" onclick="printReceipt()">Print PDF</button>
    <!-- Table for md+ screens -->
    <div id="print-area">
        <div class="table-responsive d-none d-md-block">
            <table class="table table-dark table-striped align-middle mb-0">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Product ID</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                {% for item in items %}
                    <tr>
                        <td>{{ item['name'] }}</td>
                        <td>{{ item['product_id'] }}</td>
                        <td>{{ item['quantity'] }}</td>
                        <td>{{ item['price'] }}</td>
                        <td>{{ item['subtotal'] }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <!-- Card style for mobile screens -->
        <div class="d-block d-md-none">
            {% for item in items %}
            <div class="card mb-3 bg-dark text-light border-light">
                <div class="card-body p-3">
                    <div class="row mb-2">
                        <div class="col-5 fw-bold">Item Name</div>
                        <div class="col-7">{{ item['name'] }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold">Product ID</div>
                        <div class="col-7">{{ item['product_id'] }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold">Quantity</div>
                        <div class="col-7">{{ item['quantity'] }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold">Price</div>
                        <div class="col-7">{{ item['price'] }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold">Subtotal</div>
                        <div class="col-7">{{ item['subtotal'] }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <a href="{{ url_for('admin_receipts') }}" class="btn btn-secondary mt-2">Back to Receipts</a>
</div>

<style>
.card {
    border-radius: 0.7rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    border-width: 1.5px;
}
@media print {
    body * {
        visibility: hidden;
    }
    #print-area, #print-area * {
        visibility: visible;
    }
    #print-area {
        position: absolute;
        left: 0;
        top: 0;
        width: 100vw;
        background: #fff !important;
    }
    .btn, .btn-secondary, .btn-primary, .mb-3, .mt-2 {
        display: none !important;
    }
}
</style>

<script>
function printReceipt() {
    window.print();
}
</script>
{% endblock %}