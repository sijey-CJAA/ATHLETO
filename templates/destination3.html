{% extends "base.html" %}
{% block content %}
<style>
    body {
        background: #181a1b !important;
        color: #fafafa;
    }

    .nike-product-page-outer {
        min-height: 85vh;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: 24px 0 24px 0;
    }

    .nike-product-container {
        display: flex;
        flex-direction: row;
        background: #232529;
        border-radius: 16px;
        box-shadow: 0 4px 28px rgba(0, 0, 0, 0.12);
        width: 100%;
        max-width: 1100px;
        min-height: 600px;
        gap: 0;
        overflow: hidden;
    }

    .nike-gallery-section {
        display: flex;
        flex-direction: row;
        min-width: 0;
        padding: 24px 0 24px 24px;
        background: #232529;
        border-radius: 16px 0 0 16px;
        align-items: flex-start;
        width: 55%;
        max-width: 550px;
    }

    .nike-thumbs {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-right: 12px;
        align-items: flex-start;
        justify-content: flex-start;
    }

    .nike-thumb-img {
        width: 56px;
        height: 56px;
        object-fit: cover;
        border-radius: 10px;
        border: 2px solid transparent;
        background: #222;
        cursor: pointer;
        transition: border 0.18s, box-shadow 0.18s;
        box-shadow: 0 1px 4px rgba(180, 0, 80, 0.07);
    }

    .nike-thumb-img.selected,
    .nike-thumb-img:hover {
        border: 2.5px solid #fa516a;
        box-shadow: 0 2px 7px rgba(255, 179, 203, 0.13);
    }

    .nike-main-image-flip-container {
        width: 390px;
        height: 390px;
        max-width: 95vw;
        max-height: 95vw;
        min-width: 260px;
        min-height: 260px;
        aspect-ratio: 1/1;
        perspective: 1200px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #232529;
        border-radius: 18px;
        box-shadow: 0 2px 12px rgba(30, 30, 40, 0.34);
        position: relative;
        margin: 0 auto;
    }

    .nike-main-image-flipper {
        width: 98%;
        height: 98%;
        position: relative;
        transition: transform 0.7s cubic-bezier(.4, 2, .3, 1);
        transform-style: preserve-3d;
        border-radius: 14px;
    }

    .flip-0 {
        transform: rotateY(0deg);
    }

    .flip-1 {
        transform: rotateY(120deg);
    }

    .flip-2 {
        transform: rotateY(240deg);
    }

    .nike-main-image-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #232529;
        box-shadow: 0 2px 12px rgba(30, 30, 40, 0.22);
    }

    .face-a {
        transform: rotateY(0deg);
    }

    .face-b {
        transform: rotateY(120deg);
    }

    .face-c {
        transform: rotateY(240deg);
    }

    .nike-main-image-face img {
        width: 97%;
        height: 97%;
        object-fit: cover;
        border-radius: 16px;
        background: #191c1e;
        box-shadow: 0 2px 9px rgba(100, 0, 40, 0.13);
    }

    .nike-details-section {
        flex: 1 1 0;
        min-width: 0;
        max-width: 450px;
        padding: 40px 38px 36px 38px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        background: #232529;
        border-radius: 0 16px 16px 0;
        margin-left: auto;
        color: #fff;
    }

    .nike-title {
        font-size: 2rem;
        font-weight: 700;
        color: #ff9393;
        margin-bottom: 0.1em;
        letter-spacing: 0.02em;
    }

    .nike-subtitle {
        font-size: 1.08rem;
        color: #e2e2e2;
        margin-bottom: 1.1em;
        font-style: italic;
    }

    .nike-price {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 1.1em;
        color: #fff;
    }

    .nike-btn {
        width: 100%;
        padding: 12px;
        font-weight: 700;
        font-size: 1.01rem;
        border-radius: 6px;
        cursor: pointer;
        border: none;
        margin-bottom: 11px;
        transition: background .16s, color .16s;
    }

    .nike-btn.primary {
        background-color: #ff9393;
        color: #232529;
        border: 2px solid #ff9393;
        margin-bottom: 6px;
    }

    .nike-btn.primary:hover,
    .nike-btn.primary:focus {
        background: #fff;
        color: #232529;
    }

    .nike-btn.secondary {
        background: #232529;
        color: #ff9393;
        border: 2px solid #ff9393;
    }

    .nike-btn.secondary:hover,
    .nike-btn.secondary:focus {
        background: #191c1e;
    }

    .nike-size-section {
        margin-bottom: 1.3em;
    }

    .nike-size-note {
        font-size: 0.9rem;
        color: #d6d6d6;
        margin-bottom: 0.4em;
    }

    .nike-size-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-bottom: 14px;
    }

    .nike-size-option {
        padding: 7px 0;
        font-size: 0.98rem;
        border: 1.2px solid #393a3b;
        text-align: center;
        cursor: pointer;
        border-radius: 5px;
        background: #191c1e;
        color: #ffffff;
        transition: all 0.2s;
        user-select: none;
    }

    .nike-size-option:hover,
    .nike-size-option.selected {
        background: #232529;
        border-color: #ffffff;
        color: #fff;
        outline: none;
    }

    .nike-desc-section {
        margin-top: 12px;
        font-size: 0.96rem;
        color: #e2e2e2;
        line-height: 1.6;
    }

    .nike-desc-section ul {
        margin: 12px 0 0 20px;
        padding: 0;
    }

    .nike-desc-section li {
        font-size: .91rem;
        color: #d6d6d6;
    }

    /* Responsive fixes below */
    @media (max-width: 1100px) {
        .nike-product-container {
            flex-direction: column;
            align-items: center;
            width: 99vw;
            min-height: unset;
            max-width: 98vw;
        }

        .nike-gallery-section,
        .nike-details-section {
            border-radius: 16px;
            width: 100%;
            max-width: none;
        }

        .nike-gallery-section {
            padding: 24px 0 10px 0;
            justify-content: center;
            max-width: 95vw;
            border-radius: 16px 16px 0 0;
        }

        .nike-details-section {
            padding: 28px 5vw 18px 5vw;
            max-width: 99vw;
            margin-left: 0;
            border-radius: 0 0 16px 16px;
        }

        .nike-main-image-flip-container {
            width: 60vw;
            height: 60vw;
            min-width: 200px;
            min-height: 200px;
        }

        .nike-main-image-face img {
            width: 98vw;
            height: 98vw;
            max-width: 60vw;
            max-height: 60vw;
        }
    }

    @media (max-width: 700px) {
        .nike-product-page-outer {
            padding: 8px 0;
        }

        .nike-product-container {
            width: 100vw;
            min-height: 400px;
            border-radius: 0;
            max-width: 100vw;
        }

        .nike-gallery-section {
            border-radius: 0;
            width: 100vw;
            max-width: 100vw;
            padding: 10px 0 10px 0;
            /* Remove left padding */
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .nike-thumbs {
            flex-direction: row;
            gap: 3vw;
            margin: 0 0 12px 0;
            justify-content: center;
            align-items: center;
            width: 100vw;
            max-width: 100vw;
        }

        .nike-thumb-img {
            width: 18vw;
            height: 18vw;
            min-width: 44px;
            min-height: 44px;
            max-width: 80px;
            max-height: 80px;
        }

        .nike-main-image-flip-container {
            width: 92vw;
            height: 92vw;
            max-width: 96vw;
            max-height: 96vw;
            min-width: 0;
            min-height: 0;
            margin: 0 auto;
        }

        .nike-main-image-face img {
            width: 90vw;
            height: 90vw;
            max-width: 92vw;
            max-height: 92vw;
        }
    }

    @media (max-width: 500px) {
        .nike-main-image-flip-container {
            width: 96vw;
            height: 96vw;
            min-width: 0;
            min-height: 0;
        }

        .nike-main-image-face img {
            width: 95vw;
            height: 95vw;
            max-width: 95vw;
        }

        .nike-details-section {
            padding: 3vw 1vw 2vw 1vw;
        }
    }
</style>
<div class="nike-product-page-outer">
    <div class="nike-product-container">
        <!-- Left: Image gallery section -->
        <div class="nike-gallery-section">
            <div class="nike-thumbs">
                <img src="{{ url_for('static', filename='pictures/latest/web1.png') }}" class="nike-thumb-img selected"
                    onclick="showMainImg3(0)" alt="thumb1">
                <img src="{{ url_for('static', filename='pictures/latest/web2.png') }}" class="nike-thumb-img"
                    onclick="showMainImg3(1)" alt="thumb2">
                <img src="{{ url_for('static', filename='pictures/latest/web3.png') }}" class="nike-thumb-img"
                    onclick="showMainImg3(2)" alt="thumb3">
            </div>
            <!-- 3D Flipping Cube Main Image -->
            <div class="nike-main-image-flip-container" id="flipCont3" tabindex="0">
                <div class="nike-main-image-flipper flip-0" id="flipImageBox3">
                    <div class="nike-main-image-face face-a">
                        <img id="mainNikeImgA3" src="{{ url_for('static', filename='pictures/latest/web1.png') }}"
                            alt="Main Shoe View A">
                    </div>
                    <div class="nike-main-image-face face-b">
                        <img id="mainNikeImgB3" src="{{ url_for('static', filename='pictures/latest/web2.png') }}"
                            alt="Main Shoe View B">
                    </div>
                    <div class="nike-main-image-face face-c">
                        <img id="mainNikeImgC3" src="{{ url_for('static', filename='pictures/latest/web3.png') }}"
                            alt="Main Shoe View C">
                    </div>
                </div>
            </div>
        </div>
        <!-- Right: Details section -->
        <div class="nike-details-section">
            <span class="nike-title">Athleto WebFlex Velocity</span>
            <div class="nike-subtitle">Blue Flame</div>
            <div class="nike-price">P6,795.00</div>
            <p>
                <span id="stockDisplay3" class="text-success">
                    Stock: {{ size_stock.get('M', 0) }}
                </span>
            </p>
            <form id="addToCartForm3" action="{{ url_for('add_to_cart', product_id='Extra23') }}" method="post"
                style="display:inline;">
                <input type="hidden" name="size" id="addToCartSize3" value="">
                <input type="hidden" name="quantity" id="addToCartQty3" value="1">
                <button type="submit" class="nike-btn primary" style="margin-bottom:8px;">Add to Cart</button>
            </form>
            <form id="buyNowForm3" action="{{ url_for('buy_now_info', product_id='Extra23') }}" method="post"
                style="display:inline;">
                <input type="hidden" name="size" id="buyNowSize3" value="">
                <input type="hidden" name="price" value="6795.00">
                <input type="hidden" name="quantity" id="buyNowQty3" value="1">
                <button type="submit" class="nike-btn secondary">Buy Now</button>
            </form>
            <form class="nike-size-section" onsubmit="return false;" style="margin-top:18px;">
                <div class="nike-size-grid" id="sizeGrid3">
                    <div class="nike-size-option">XS</div>
                    <div class="nike-size-option">S</div>
                    <div class="nike-size-option">M</div>
                    <div class="nike-size-option">L</div>
                    <div class="nike-size-option">XL</div>
                </div>
            </form>
            <div class="nike-desc-section">
                <p>
                    The fearless are spun from strength and style. This Athleto WebFlex Velocity jacket pays homage to
                    the
                    iconic hero’s bold legacy. Vivid red and electric blue panels weave together, symbolizing courage
                    and
                    agility that swing through every challenge. The web-patterned texture mimics the intricate strength
                    of
                    a spider’s silk, while a sleek black metal logo on the chest sharpens the jacket’s striking
                    silhouette.
                    The WebFlex Velocity is crafted for those who move with purpose, ready to conquer the city with
                    every
                    step and spin their own web of success.
                </p>
                <ul>
                    <li>Colour Shown: Blue/Red/Dark Blue/White</li>
                    <li>Style: ATH-PRO-WEB</li>
                    <li>Country/Region of Origin: Philippines</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<script>
    // Images for three faces (web)
    const imgs3 = [
        "{{ url_for('static', filename='pictures/latest/web1.png') }}",
        "{{ url_for('static', filename='pictures/latest/web2.png') }}",
        "{{ url_for('static', filename='pictures/latest/web3.png') }}"
    ];
    let currentFace3 = 0;

    function updateImages3(idx) {
        document.getElementById('mainNikeImgA3').src = imgs3[idx];
        document.getElementById('mainNikeImgB3').src = imgs3[(idx + 1) % 3];
        document.getElementById('mainNikeImgC3').src = imgs3[(idx + 2) % 3];
        document.querySelectorAll('.nike-thumb-img').forEach((el, i) => {
            if (i === idx) el.classList.add('selected');
            else el.classList.remove('selected');
        });
    }
    function showMainImg3(idx) {
        currentFace3 = idx;
        updateImages3(currentFace3);
        setFlip3(0);
    }
    let flipState3 = 0;
    function setFlip3(flipNum) {
        flipState3 = flipNum % 3;
        const box3 = document.getElementById('flipImageBox3');
        box3.classList.remove('flip-0', 'flip-1', 'flip-2');
        box3.classList.add('flip-' + flipState3);
    }
    // Flipping effect
    let flipTimeouts3 = [];
    function tripleFlip3() {
        clearTimeouts3();
        setFlip3(1);
        flipTimeouts3.push(setTimeout(() => { setFlip3(2); }, 350));
        flipTimeouts3.push(setTimeout(() => { setFlip3(0); }, 700));
    }
    function clearTimeouts3() {
        flipTimeouts3.forEach(t => clearTimeout(t));
        flipTimeouts3 = [];
    }
    window.addEventListener('DOMContentLoaded', function () {
        // Setup event listeners for flip
        const flipCont3 = document.getElementById('flipCont3');
        if (flipCont3) {
            flipCont3.addEventListener('mouseenter', tripleFlip3);
            flipCont3.addEventListener('focus', tripleFlip3);
            flipCont3.addEventListener('mouseleave', () => { clearTimeouts3(); setFlip3(0); });
            flipCont3.addEventListener('blur', () => { clearTimeouts3(); setFlip3(0); });
        }

        // Size selection & form integration for destination3
        let selectedSize3 = '';
        document.querySelectorAll('#sizeGrid3 .nike-size-option').forEach(el => {
            el.addEventListener('click', function () {
                document.querySelectorAll('#sizeGrid3 .nike-size-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                selectedSize3 = this.innerText;
                document.getElementById('addToCartSize3').value = selectedSize3;
                document.getElementById('buyNowSize3').value = selectedSize3;
            });
        });
        document.getElementById('addToCartForm3').addEventListener('submit', function (e) {
            if (!document.getElementById('addToCartSize3').value) {
                alert('Please select a size before adding to cart!');
                e.preventDefault();
            }
        });
        document.getElementById('buyNowForm3').addEventListener('submit', function (e) {
            if (!document.getElementById('buyNowSize3').value) {
                alert('Please select a size before buying!');
                e.preventDefault();
            }
        });

        // Initial images and flip state
        updateImages3(0);
        setFlip3(0);
    });
</script>

<script id="size-stock-data-3" type="application/json">
  {{ size_stock | tojson }}
</script>
<script>
  const sizeStock3 = JSON.parse(document.getElementById("size-stock-data-3").textContent);
  const sizeOptions3 = document.querySelectorAll('#sizeGrid3 .nike-size-option');
  const stockDisplay3 = document.getElementById("stockDisplay3");

  function updateStockDisplay3(selectedSize) {
    const stock = sizeStock3[selectedSize] || 0;
    stockDisplay3.textContent = "Stock: " + stock;
  }

  sizeOptions3.forEach(option => {
    option.addEventListener('click', function () {
      updateStockDisplay3(this.innerText);
    });
  });

  // Initialize on page load (default to M)
  window.addEventListener("DOMContentLoaded", function () {
    let selected = document.querySelector('#sizeGrid3 .nike-size-option.selected');
    updateStockDisplay3(selected ? selected.innerText : 'M');
  });
</script>


{% endblock %}